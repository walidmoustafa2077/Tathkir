<UserControl x:Class="Tathkīr_WPF.Views.GenericViews.HomeControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:Convertors="clr-namespace:Tathkīr_WPF.Converters"
             xmlns:local="clr-namespace:Tathkīr_WPF">

    <ScrollViewer Padding="16"
                  Background="#20F2FBFF">
        <Grid Margin="12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- Current Day Widget -->
            <Border Grid.Row="0"
                    Grid.ColumnSpan="2"
                    Margin="0,0,0,16"
                    CornerRadius="12"
                    Padding="20"
                    Background="#CC0D7377"
                    Effect="{DynamicResource MaterialDesignElevationShadow}">

                <StackPanel>
                    <!-- top date -->
                    <TextBlock Text="{Binding CurrentDate}"
                               Foreground="White"
                               FontSize="14"
                               FontWeight="Medium"
                               HorizontalAlignment="Center"
                               Margin="0,8,0,0" />


                    <StackPanel HorizontalAlignment="Center"
                                Margin="0,8,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="18" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0"
                                        Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="{Binding NextPrayerIcon}"
                                                         Width="32"
                                                         Height="32"
                                                         Foreground="White"
                                                         VerticalAlignment="Center"
                                                         Margin="0,0,8,0" />

                                <TextBlock Text="{Binding NextPrayerName}"
                                           FontSize="20"
                                           Foreground="White"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,6" />
                            </StackPanel>

                            <TextBlock Grid.Column="2"
                                       Text="{Binding Countdown}"
                                       FontSize="22"
                                       FontWeight="Medium"
                                       Foreground="White"
                                       HorizontalAlignment="Center" />

                        </Grid>

                        <TextBlock Text="{Binding NextPrayerTime}"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   Foreground="White"
                                   Margin="0 12 0 0"
                                   HorizontalAlignment="Center" />

                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Prayer Times Widget -->
            <Border Grid.Row="1"
                    Grid.ColumnSpan="2"
                    CornerRadius="10"
                    Background="#CC2196F3"
                    Margin="0,0,8,16"
                    Padding="16"
                    Effect="{DynamicResource MaterialDesignElevationShadow}">
                <StackPanel>
                    <TextBlock Text="{x:Static local:Strings.Prayer_Times}"
                               FontWeight="Bold"
                               Margin="0,0,0,18"
                               Foreground="White"
                               HorizontalAlignment="Center"
                               Style="{StaticResource MaterialDesignHeadline5TextBlock}" />

                    <ItemsControl ItemsSource="{Binding PrayerList}"
                                  HorizontalAlignment="Center">
                        <!-- Horizontal panel -->
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Width="90"
                                            Margin="4"
                                            VerticalAlignment="Center">
                                    <!-- Icon -->
                                    <materialDesign:PackIcon Kind="{Binding Icon}"
                                                             Width="28"
                                                             Height="28"
                                                             Foreground="White"
                                                             HorizontalAlignment="Center"
                                                             Margin="0,0,0,4" />
                                    <!-- Prayer Name -->
                                    <TextBlock Text="{Binding Name}"
                                               FontSize="14"
                                               Foreground="White"
                                               HorizontalAlignment="Center"
                                               Margin="0,0,0,2" />
                                    <!-- Time -->
                                    <TextBlock Text="{Binding Time}"
                                               FontSize="14"
                                               Foreground="White"
                                               HorizontalAlignment="Center" />
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Calendar Widget -->
            <Border Grid.Row="2"
                    CornerRadius="10"
                    Padding="12"
                    Background="#25FFFFFF"
                    Effect="{DynamicResource MaterialDesignElevationShadow}">

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- Tasbeeh Widget -->
                    <Border Grid.Column="0"
                            Padding="16">
                        <StackPanel>

                            <TextBlock Text="Tasbeeh"
                                       FontWeight="Bold"
                                       FontSize="16"
                                       Foreground="#263238"
                                       Margin="0,0,0,12" />

                            <!-- Tasbeeh Button -->
                            <StackPanel HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Margin="0 12">

                                <Button Width="160"
                                        Height="160"
                                        Command="{Binding IncrementTasbeehCommand}">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Grid>
                                                <!-- Ellipse Background -->
                                                <Ellipse x:Name="EllipseBg"
                                                         Width="150"
                                                         Height="150"
                                                         Fill="#14A098">
                                                    <Ellipse.RenderTransform>
                                                        <ScaleTransform ScaleX="1"
                                                                        ScaleY="1" />
                                                    </Ellipse.RenderTransform>
                                                    <Ellipse.Effect>
                                                        <DropShadowEffect Color="Black"
                                                                          BlurRadius="12"
                                                                          Opacity="0.2" />
                                                    </Ellipse.Effect>
                                                </Ellipse>

                                                <!-- Text inside the Ellipse -->
                                                <StackPanel x:Name="TextContainer"
                                                            Orientation="Horizontal"
                                                            VerticalAlignment="Center"
                                                            HorizontalAlignment="Center">
                                                    <StackPanel.RenderTransform>
                                                        <ScaleTransform ScaleX="1"
                                                                        ScaleY="1" />
                                                    </StackPanel.RenderTransform>

                                                    <TextBlock Text="{Binding TasbeehLimit}"
                                                               FontSize="18"
                                                               Foreground="White"
                                                               Margin="4,0" />
                                                    <TextBlock Text="/"
                                                               FontSize="18"
                                                               Foreground="White"
                                                               Margin="4,0" />
                                                    <TextBlock Text="{Binding TasbeehCount}"
                                                               FontSize="32"
                                                               FontWeight="Bold"
                                                               Foreground="White"
                                                               Margin="4,0" />
                                                </StackPanel>

                                                <!-- Visual States -->
                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CommonStates">
                                                        <VisualState x:Name="Normal" />

                                                        <VisualState x:Name="MouseOver">
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetName="EllipseBg"
                                                                                Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)"
                                                                                To="#1DB9A8"
                                                                                Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </VisualState>

                                                        <VisualState x:Name="Pressed">
                                                            <Storyboard>
                                                                <!-- Ellipse animations -->
                                                                <ColorAnimation Storyboard.TargetName="EllipseBg"
                                                                                Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)"
                                                                                To="#0E8C7F"
                                                                                Duration="0:0:0.1" />
                                                                <DoubleAnimation Storyboard.TargetName="EllipseBg"
                                                                                 Storyboard.TargetProperty="RenderTransform.ScaleX"
                                                                                 To="0.9"
                                                                                 Duration="0:0:0.1" />
                                                                <DoubleAnimation Storyboard.TargetName="EllipseBg"
                                                                                 Storyboard.TargetProperty="RenderTransform.ScaleY"
                                                                                 To="0.9"
                                                                                 Duration="0:0:0.1" />

                                                                <!-- TextContainer scale animation -->
                                                                <DoubleAnimation Storyboard.TargetName="TextContainer"
                                                                                 Storyboard.TargetProperty="RenderTransform.ScaleX"
                                                                                 To="0.9"
                                                                                 Duration="0:0:0.1" />
                                                                <DoubleAnimation Storyboard.TargetName="TextContainer"
                                                                                 Storyboard.TargetProperty="RenderTransform.ScaleY"
                                                                                 To="0.9"
                                                                                 Duration="0:0:0.1" />
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>
                                            </Grid>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>

                                <!-- Total count (outside Ellipse) -->
                                <TextBlock Text="{Binding TasbeehTotal}"
                                           FontSize="15"
                                           Foreground="#37474F"
                                           HorizontalAlignment="Center"
                                           Margin="0,4,0,0" />
                            </StackPanel>

                            <!-- Dropdown to select TasbeehLimit -->
                            <StackPanel VerticalAlignment="Center"
                                        HorizontalAlignment="Stretch"
                                        Margin="12 16">
                                <TextBlock Text="Select Tasbeeh Limit"
                                           FontSize="14"
                                           Foreground="#37474F"
                                           Margin="0,0,0,4" />

                                <ComboBox ItemsSource="{Binding TasbeehLimits}"
                                          SelectedItem="{Binding TasbeehLimit, Mode=TwoWay}"
                                          Height="32"
                                          Padding="4"
                                          Style="{StaticResource MaterialDesignOutlinedComboBox}" />
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Tasbeeh Widget -->
                    <Border Grid.Column="1"
                            Padding="16">
                        <StackPanel >
                            <TextBlock Text="Islamic Calendar"
                                       FontWeight="Bold"
                                       FontSize="16"
                                       Foreground="#263238"
                                       Margin="0,0,0,12" />
                            <Calendar x:Name="HijriCalendar"
                                      SelectedDate="{Binding SelectedDate}"
                                      DisplayDate="{Binding CurrentMonth, Mode=OneWay}"
                                      Language="ar-SA"
                                      FlowDirection="RightToLeft"
                                      BorderThickness="0"
                                      Foreground="#37474F"
                                      Loaded="HijriCalendar_Loaded"
                                      DisplayDateChanged="HijriCalendar_DisplayDateChanged"
                                      SelectedDatesChanged="HijriCalendar_SelectedDatesChanged" />

                        </StackPanel>

                    </Border>
                </Grid>
            </Border>
        </Grid>

    </ScrollViewer>
</UserControl>
