<UserControl x:Class="Tathkīr_WPF.Views.Dialogs.SurahDialogControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:local="clr-namespace:Tathkīr_WPF"
             FontFamily="pack://application:,,,/Resources/Fonts/#KFGQPC Uthmanic Script HAFS">

    <Border CornerRadius="12"
            Background="White"
            Padding="18"
            MinWidth="400"
            MaxWidth="740"
            MaxHeight="500"
            Focusable="True"
            FocusVisualStyle="{x:Null}"
            PreviewKeyDown="Border_PreviewKeyDown">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <!-- Surah Info -->
                <RowDefinition Height="*" />
                <!-- Verses -->
                <RowDefinition Height="Auto" />
                <!-- Controls -->
            </Grid.RowDefinitions>

            <!-- Close button -->
            <Button Grid.Row="0"
                    Content="X"
                    Width="32"
                    Height="32"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Margin="8,0,0,0"
                    Padding="0"
                    FontSize="18"
                    FontWeight="Bold"
                    Command="{Binding CloseDialog}"
                    Style="{StaticResource MaterialDesignFlatButton}"
                    Panel.ZIndex="900">
            </Button>

            <Border Grid.Row="1"
                    CornerRadius="12"
                    BorderThickness="2"
                    BorderBrush="#8B6F47"
                    Background="#FDF8F2"
                    Margin="28 6 28 14">

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <!-- Left ornament -->
                        <ColumnDefinition Width="*" />
                        <!-- Center content -->
                        <ColumnDefinition Width="Auto" />
                        <!-- Right ornament -->
                    </Grid.ColumnDefinitions>

                    <!-- Left ornament -->
                    <materialDesign:PackIcon Grid.Column="0"
                                             Kind="Flower"
                                             Foreground="#8B6F47"
                                             Width="32"
                                             Height="32"
                                             VerticalAlignment="Center"
                                             Margin="8,0" />

                    <!-- Center Surah info -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FlowDirection="RightToLeft">
                        <TextBlock Text="{Binding Surah.Name.DisplayName}"
                                   FontSize="28"
                                   FontWeight="Bold"
                                   Foreground="#37474F"
                                   TextAlignment="Center" />
                    </StackPanel>

                    <!-- Right ornament -->
                    <materialDesign:PackIcon Grid.Column="2"
                                             Kind="Flower"
                                             Foreground="#8B6F47"
                                             Width="32"
                                             Height="32"
                                             VerticalAlignment="Center"
                                             Margin="8,0" />
                </Grid>
            </Border>


            <!-- Verses Scrollable -->
            <ScrollViewer Grid.Row="2"
                          VerticalScrollBarVisibility="Auto"
                          Padding="12">
                <StackPanel x:Name="VerseContainer"
                            Margin="16 0">
                    <TextBlock x:Name="FirstVerseTextBlock"
                               TextAlignment="Center"
                               TextWrapping="Wrap"
                               FontSize="32"
                               TextOptions.TextFormattingMode="Display"
                               TextOptions.TextHintingMode="Fixed"
                               TextOptions.TextRenderingMode="ClearType" />

                    <TextBlock x:Name="RemainingVersesTextBlock"
                               TextAlignment="Center"
                               TextWrapping="Wrap"
                               FontSize="32"
                               LineHeight="60"
                               TextOptions.TextFormattingMode="Display"
                               TextOptions.TextHintingMode="Fixed"
                               TextOptions.TextRenderingMode="ClearType" />
                </StackPanel>

            </ScrollViewer>

            <!-- Slider -->
            <Slider Grid.Row="3"
                    Minimum="0"
                    Maximum="{Binding MediaDuration}"
                    Value="{Binding MediaPosition, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    IsMoveToPointEnabled="True"
                    VerticalAlignment="Top"
                    Margin="20,0"
                    PreviewMouseDown="Slider_PreviewMouseDown"
                    PreviewMouseUp="Slider_PreviewMouseUp" />

            <!-- Controls -->
            <DockPanel Grid.Row="3"
                       HorizontalAlignment="Stretch"
                       Margin="0,18,0,6">

                <ComboBox x:Name="comboBox"
                          ItemsSource="{Binding Readers}"
                          SelectedItem="{Binding SelectedReader, Mode=TwoWay}"
                          Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                          FontSize="16"
                          Width="260"
                          Height="30"
                          Padding="4 0"
                          Margin="18 4"
                          IsEditable="True"
                          IsTextSearchEnabled="False"
                          StaysOpenOnEdit="True"
                          HorizontalAlignment="Right"
                          TextBoxBase.TextChanged="ComboBox_TextChanged"
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"
                          materialDesign:HintAssist.HelperText="{x:Static local:Strings.Choose_The_Reader}"
                          materialDesign:HintAssist.HelperTextFontSize="12" />

                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center">
                    <StackPanel Orientation="Horizontal"
                                FlowDirection="LeftToRight">

                        <!-- Loop Enabled -->
                        <Button Command="{Binding LoopSurahCommand}"
                                ToolTip="{Binding LoopStatus}"
                                Style="{StaticResource MaterialDesignIconButton}">
                            <materialDesign:PackIcon Kind="Loop"
                                                     Width="28"
                                                     Height="28" />
                        </Button>

                        <!-- Stop -->
                        <Button Command="{Binding StopSurahCommand}"
                                ToolTip="{x:Static local:Strings.Stop}"
                                Style="{StaticResource MaterialDesignIconButton}">
                            <materialDesign:PackIcon Kind="Stop"
                                                     Width="28"
                                                     Height="28" />
                        </Button>

                        <!-- Play / Pause -->
                        <Button Command="{Binding PlaySurahCommand}"
                                Style="{StaticResource MaterialDesignIconButton}"
                                ToolTip="{x:Static local:Strings.Play}"
                                Visibility="{Binding IsPlay, Converter={StaticResource BoolToVisibilityConverter}}">

                            <materialDesign:PackIcon Kind="Play"
                                                     Width="28"
                                                     Height="28" />
                        </Button>

                        <Button Command="{Binding PlaySurahCommand}"
                                Style="{StaticResource MaterialDesignIconButton}"
                                ToolTip="{x:Static local:Strings.Pause}"
                                Visibility="{Binding IsPause, Converter={StaticResource BoolToVisibilityConverter}}">
                            <materialDesign:PackIcon Kind="Pause"
                                                     Width="28"
                                                     Height="28" />
                        </Button>

                    </StackPanel>

                    <!-- Bookmark -->
                    <Button Command="{Binding BookmarkSurahCommand}"
                            ToolTip="{x:Static local:Strings.Bookmark}"
                            Style="{StaticResource MaterialDesignIconButton}">
                        <materialDesign:PackIcon Kind="BookmarkOutline"
                                                 Width="28"
                                                 Height="28" />
                    </Button>
                </StackPanel>
            </DockPanel>
        </Grid>
    </Border>
</UserControl>
